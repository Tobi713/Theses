%% THIS IS THE MAIN FILE %%
% Here the main arrangement of your thesis is determined. 
% In this file you read-in all chapters (as separate .tex files)
% This is also the file you 'Build' with a LaTeX editor, like TeXmaker.
% The .cls file (MScThesis.cls) contains all details regarding copyrights and so on. Take a look and adjust where applicable. But be careful changing this file: it determines the whole lay-out of your thesis!
% This MSc thesis standard layout is optimized for double sided printing on A4 format paper.
% Good luck and have fun with your Master Research in Applied Geophysics! Kind regards, Niels Grobbe

\documentclass[a4paper,11pt]{MScThesis}
%
%\usepackage{pifont}
\usepackage{graphicx}
\usepackage{natbib}
\usepackage{subcaption}
\usepackage{wrapfig}
\usepackage{booktabs}
\usepackage{pdfpages}
\graphicspath{Figures/}
%\usepackage{mathpazo}
\mscName{Fabian Antonio Stamm}
\mscDate{\today}
\mscTitle{Bayesian Decision Theory in Structural Geological Modeling}
\mscSubTitle{How Reducing Uncertainties Affects Reservoir Value Estimations}
\mscKeyWords{thesis, msc, subject}
%
%\mscBackPicture{2660PF3}    % eps of 21 * 29.7 cm
\mscReaderOne{Prof. Florian Wellmann, Ph.D.}
\mscReaderTwo{Prof. Dr. Janos Urai}
\mscReaderThree{Miguel de la Varga, M.Sc.}
%\mscReaderFour{}
%
\setThesisInfo
%
\begin{document}
%
%============================= Front matter ========================================
\frontmatter %
%
% Make a hell of a lot of title pages
    \maketitle
%
\includepdf[pages={1}]{eidesstattliche_erklaerung3.pdf}

\cleardoublepage



% Abstract
\nonumchap{Abstract}
Bayesian decision theory is applicable to a wide spectrum of problems. Hydrocarbon exploration and production is a high-risk, high-reward sector in which good decision making is indispensable. Actors in this field are faced by numerous uncertainties that have to be considered. Structural geological modeling is of central importance for the assessment of uncertain hydrocarbon accumulations in potential reservoirs. By regarding such modeling as a Bayesian inference problem, additional geological information can be incorporated as likelihood functions linked to prior parameters in a probabilistic framework. Markov chain Monte Carlo sampling is used to approximate posterior models of reduced uncertainty. Here, synthetic geological models are constructed to represent potential hydrocarbon systems. Algorithms for automatic trap recognition are developed to enable the reservoir valuation of prior and posterior models. These serve as a base for true value estimation by respective optimization of a case-specific loss function. This function is customized to reflect the decision making of differently risk-affine actors. Results from conducting this for several inference cases show that the various Bayes estimators shift according to the characteristics of the underlying value distribution. While bimodality and overall uncertainty leads to separation, risk-averse and risk-friendly decisions converge and decrease in expected loss given narrower unimodal distributions. The degree of decision convergence is considered a measure for the state of knowledge and its inherent uncertainty at the moment of decision making. This decisive uncertainty does not change aligned with model uncertainty but depends on alterations of critical parameters and respective interdependencies, in particular relating to seal reliability. Additionally, actors are affected differently by one set of information, as defined by their risk affinity. For good decision making, it appears to be most important to recognize for which parameters reduction of uncertainty leads to changes in decisions.



%Please pay particular attention to the preparation of your abstract; use this text as a guide. Every master thesis report must be accompanied by an informative abstract of no more than one paragraph (max 300 words). The abstract should be self-contained. No references, figures, tables, or equations are allowed in an abstract. Do not use new terminology in an abstract unless it is defined or is well-known from the literature. The abstract must not simply list the topics covered in the paper but should (1) state the scope and principal objectives of the research, (2) describe the methods used, (3) summarize the results, and (4) state the principal conclusions. Do not refer to the master thesis report itself in the abstract. For example, do not say, "In this thesis we will discuss". Furthermore the abstract must stand alone as a very short version of the master thesis report rather than as a description of the contents. Remember that the abstract will be the first and most widely read portion of the master thesis report. Readers will be influenced by the abstract to the point that they decide to read the master thesis report or not.

    \cleardoublepage
%
% Acknowledgements
    \nonumchap{Acknowledgements}%
    First and foremost, I wish to express my greatest thanks to Miguel de la Varga, whose outstanding support I have received since he was my tutor in Numerical Reservoir Engineering. He encouraged me to challenge myself and to pursue a path into a research field that, not long ago, was very much unfamiliar to me. I am grateful for the continuous motivation, constant positive feedback and especially the immense patience he showed as my supervisor and mentor.\\
    Furthermore, I want to voice my gratitude to Professor Florian Wellmann, for welcoming me as a part of his research group and thus showing me how exciting and inspiring it can be to participate in a free and forward-thinking academic environment. With his interest, openness and positive attitude, he encouraged me to contribute to his group's work and to develop my own scientific ideas.\\
    I also wish to thank Professor Janos Urai, for years of fascinating lectures on structural geology, hydrocarbon exploration and production, as well as related risk analysis. His courses provided me with many insights and served as sources of inspiration and information that I was able to include in this project.\\
    In general, I am grateful to my friends and fellow researchers from the CGRE group, especially for creating such a pleasant working atmosphere. Special thanks go to the modeling team. To Alexander Schaaf, for helping me with GemPy when Miguel could not be found and reminding me to take a break now and then. To Marco van Veen, for endless inciting and exhilarating discussions, but also for the many shared adventures during our geoscientific studies.\\
    And of course, I owe my deepest gratitude to my family, for a lifetime of unconditional support. To my parents, for raising me to be curious, for enabling me to attain such excellent education and for providing me with the freedom to follow my individual interests and aspirations.
    \vspace*{15mm}

    \noindent 
    RWTH Aachen University \hfill \mscname\\ % choose the university where you carried out your final MSc thesis research
    \mscdate

%
% table of contents, (\toc or \toclof or \tocloflot )
    \tocloflot
%
% Nomenclature
    %\printnomencl %
%
% Acronyms
    \nonumchap{Acronyms} %
    %
    \begin{acronym}%
    	\acro{MAP}{Maximum a posteriori}%
        \acro{MCMC}{Markov chain Monte Carlo}
        \acro{NPV}{Net present value}%
        \acro{OOIP}{Original oil-in-place}
        \acro{ROV}{Recoverable oil volumes}%
        \acro{SSF}{Shale Smear Factor}
    \end{acronym}%
    %
    \cleardoublepage%
%
%
%============================= Main matter =========================================
%
\mainmatter
%
% Introduction
%\include{chapter1} % notice how the reference to the introduction takes place.. It refers to the name.tex

\cleardoublepage
		\include{chapter1}
		\include{chapter2_methods}
		\include{chapter3_results}
		\include{chapter4_discussion}
		%\include{chapter5_conclusion}
		%\include{chapter3_1Dcase}
		%\include{chapter4_3Dcase}




%
% Bibliography
    \bibliographystyle{apalike}
    \printbib{complete_biblio} % in MyBib.bib you add all your reference information, following the correct format.
    % The *.bin file needs to be compiled using the Bib-compile option of your LaTeX text editor. Sometimes, the bib file needs to be built several times, as well as the main file, before all references occur correctly in your PDF.


%============================= Back matter =========================================
\appendix

    \chapter{Appendix}
    \section{Code availability}
    	GemPy and PyMC are both fully open source and to be used in a Python environment. At the time of writing this, GemPy is still under development (version 0.997). It can be obtained from \url{https://github.com/cgre-aachen/gempy}. PyMC can be downloaded from \url{https://github.com/pymc-devs/pymc} (PyMC2) and \url{https://github.com/pymc-devs/pymc3} (PyMC3).\\
    	The models, algorithms and functions developed and presented in this work are accessible as IPython Notebooks on github: \url{https://github.com/nre-aachen/Theses/tree/master/Risk analysis}.
\newpage
    \section{Additional tables and figures}
    
    \begin{figure}[h]
    	\centering
    	\includegraphics[width=0.5\textwidth]{Figures/Appendix/update_goodseal1}
    	\caption{Prior (A1) and posterior distributions (B1) of the layer boundary positions in depth and respective representations (A2, B2) for 1D inference case II.}\label{fig:update_goodseal1}
    \end{figure}

	\begin{figure}[h]
		\centering
		\includegraphics[width=0.5\textwidth]{Figures/Appendix/update_smallres1}
		\caption{Prior (A1) and posterior distributions (B1) of the layer boundary positions in depth and respective representations (A2, B2) for 1D inference case III.}\label{fig:update_smallres1}
	\end{figure}

    \begin{figure}[h]
    	\centering
    	\includegraphics[width=0.62\textwidth]{Figures/Appendix/CSV_input1}
    	\caption{3D model construction input data (1): point-positional values for layer interfaces and the fault surface.}\label{fig:CSV_input1}
    \end{figure}

	\begin{figure}[h]
		\centering
		\includegraphics[width=0.62\textwidth]{Figures/Appendix/CSV_input2}
		\caption{3D model construction input data (2): point-positional values for layer interfaces and the fault surface.}\label{fig:CSV_input2}
	\end{figure}

	\begin{figure}[h]
		\centering
		\includegraphics[width=1\textwidth]{Figures/Appendix/CSV_input3}
		\caption{3D model construction input data (3): dip-related values for layer interfaces and the fault surface.}\label{fig:CSV_input3}
	\end{figure}

    \begin{figure}[p!]
    	\centering
    	\includegraphics[width=1\textwidth]{Figures/Appendix/ML3}
    	\caption{Summary of results from evaluating posterior model II (3D). Shannon entropies in prior (a) and posterior (b) are compared. So are the mechanisms of maximum trap volume control (c). Prior and posterior ROV probability distributions are shown in (d). Respective loss function and Bayes actions are plotted in (e).}\label{fig:ML3}
    \end{figure}

	\begin{figure}[h]
		\begin{subfigure}{1\textwidth}
			\centering
			\includegraphics[width=1\linewidth]{Figures/Appendix/ML1/Geweke_ML1.eps}
			\caption{Geweke plots for uncertain priors.}
			%\label{fig:sfig1}
		\end{subfigure}%
		\\
		\begin{subfigure}{1\textwidth}
			\centering
			\includegraphics[width=1\linewidth]{Figures/Appendix/ML1/Traces_ML1.eps}
			\caption{Traces for uncertain priors.}
			%\label{fig:sfig2}
		\end{subfigure}
		\caption{3D posterior model I: Geweke convergence analysis (a) and plotted traces (b) for uncertain priors. In (a), the standard deviation between the mean value of one trace interval and the following is represented by the Z-score. Scores in the range between -2 and 2 indicate convergence of the MCMC sampling process.}
		\label{fig:gew_ML1}
	\end{figure}

	\begin{figure}[h]
		\begin{subfigure}{1\textwidth}
			\centering
			\includegraphics[width=1\linewidth]{Figures/Appendix/ML3/Geweke_ML3.eps}
			\caption{Geweke plots for uncertain priors.}
			%\label{fig:sfig1}
		\end{subfigure}%
		\\
		\begin{subfigure}{1\textwidth}
			\centering
			\includegraphics[width=1\linewidth]{Figures/Appendix/ML3/Traces_ML3.eps}
			\caption{Traces for uncertain priors.}
			%\label{fig:sfig2}
		\end{subfigure}
		\caption{3D posterior model II: Geweke convergence analysis (a) and plotted traces (b) for uncertain priors. In (a), the standard deviation between the mean value of one trace interval and the following is represented by the Z-score. Scores in the range between -2 and 2 indicate convergence of the MCMC sampling process.}
		\label{fig:gew_ML2}
	\end{figure}
	
	\begin{figure}[h]
		\begin{subfigure}{1\textwidth}
			\centering
			\includegraphics[width=1\linewidth]{Figures/Appendix/ML2/Geweke_ML2.eps}
			\caption{Geweke plots for uncertain priors.}
			%\label{fig:sfig1}
		\end{subfigure}%
		\\
		\begin{subfigure}{1\textwidth}
			\centering
			\includegraphics[width=1\linewidth]{Figures/Appendix/ML2/Traces_ML2.eps}
			\caption{Traces for uncertain priors.}
			%\label{fig:sfig2}
		\end{subfigure}
		\caption{3D posterior model III: Geweke convergence analysis (a) and plotted traces (b) for uncertain priors. In (a), the standard deviation between the mean value of one trace interval and the following is represented by the Z-score. Scores in the range between -2 and 2 indicate convergence of the MCMC sampling process.}
		\label{fig:gew_ML3}
	\end{figure}
	
	\begin{figure}[h]
		\begin{subfigure}{1\textwidth}
			\centering
			\includegraphics[width=1\linewidth]{Figures/Appendix/ML4/Geweke_ML4.eps}
			\caption{Geweke plots for uncertain priors.}
			%\label{fig:sfig1}
		\end{subfigure}%
		\\
		\begin{subfigure}{1\textwidth}
			\centering
			\includegraphics[width=1\linewidth]{Figures/Appendix/ML4/Traces_ML4.eps}
			\caption{Traces for uncertain priors.}
			%\label{fig:sfig2}
		\end{subfigure}
		\caption{3D posterior model IV: Geweke convergence analysis (a) and plotted traces (b) for uncertain priors. In (a), the standard deviation between the mean value of one trace interval and the following is represented by the Z-score. Scores in the range between -2 and 2 indicate convergence of the MCMC sampling process.}
		\label{fig:gew_ML4}
	\end{figure}
	
	\begin{figure}[h]
		\begin{subfigure}{1\textwidth}
			\centering
			\includegraphics[width=1\linewidth]{Figures/Appendix/ML5/Geweke_ML5.eps}
			\caption{Geweke plots for uncertain priors.}
			%\label{fig:sfig1}
		\end{subfigure}%
		\\
		\begin{subfigure}{1\textwidth}
			\centering
			\includegraphics[width=1\linewidth]{Figures/Appendix/ML5/Traces_ML5.eps}
			\caption{Traces for uncertain priors.}
			%\label{fig:sfig2}
		\end{subfigure}
		\caption{3D posterior model V: Geweke convergence analysis (a) and plotted traces (b) for uncertain priors. In (a), the standard deviation between the mean value of one trace interval and the following is represented by the Z-score. Scores in the range between -2 and 2 indicate convergence of the MCMC sampling process.}
		\label{fig:gew_ML5}
	\end{figure}
    %\section{Another test section}

    %Ok, all is well.

% Index
    \printindex
    \cleardoublepage

\end{document}

